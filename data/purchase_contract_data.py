# 导入文件的链接
from utils.get_future_day import get_future_date
from utils.get_pass_day import get_pass_date
from utils.get_today import get_today_date

purchase_contract_file_path = "https://oss.newpearl.com/newpearl/doc/2021-03-03/08fc1d1f61374feba86fb287449b8e06.xls"

# 采购合同物料明细
detailsJson = [
    {
        "id": 432338,
        "contractNo": "PC210303012",
        "itemSeq": 1,
        "itemClass": "Details",
        "itemClassName": "明细",
        "detailsStatus": "Draft",
        "matCode": "14305701710081",
        "matName": "电线-高柔RV10-德国-和柔",
        "special": "高柔RV10",
        "materialSize": "",
        "supmatCode": "test001",
        "supmatName": "测试数据1",
        "matShorthand": "电线",
        "parentNames": "W-五金仓库》143-电器类》143057-电线类",
        "materialQualityCode": "",
        "materialQualityName": "",
        "mmsatShow": "",
        "placeOfProd": "德国",
        "brand": "和柔",
        "brandCodes": "",
        "brandNames": "",
        "matgroupCode": "1430570171",
        "matgroupName": "铜芯线",
        "currencyCode": "RMB",
        "pUomType": "lengthUom",
        "pUomName": "长度单位",
        "uomTypeName": "",
        "contractUomId": "unit006",
        "contractUom": "米",
        "purchaseUomId": "unit006",
        "purchaseUom": "米",
        "stockUomPrice": 12.563,
        "stockUomDigit": "",
        "uomRate": 1,
        "price": 12.563,
        "auxiliaryPrice": "",
        "digit": "",
        "amount": "",
        "materialDescription": "",
        "incidentals": "",
        "printPrice": "",
        "printPprice": "",
        "pprice": "",
        "size": "",
        "binding": "",
        "technology": "",
        "advertiseOrganization": "",
        "advertiseAttribute": "",
        "isFreight": "N",
        "isFreightName": "否",
        "isCarton": "N",
        "isCartonName": "否",
        "ratio": 0,
        "matgroupSpecial": "",
        "matgroupGrade": "",
        "matgroupPlaceOfProd": "",
        "dRemark": "",
        "packingStandard": "",
        "itemType": "Routine",
        "itemTypeName": "常规",
        "inDigit": "",
        "inAmount": "",
        "noInDigit": "",
        "noInAmount": "",
        "changeCode": "",
        "stopReason": "",
        "stopDate": "",
        "creator": "1000078",
        "creatorName": "严冠明",
        "createTime": "2021-03-03 16:25:58",
        "removed": "false",
        "lastModifierId": "1000078",
        "lastModifierName": "严冠明",
        "lastModifierTime": "2021-03-03 16:25:58",
        "deposit": "N",
        "depositName": "否",
        "stockDigits": 0,
        "dremark": "",
        "_XID": "row_340",
    },
    {
        "id": 432339,
        "contractNo": "PC210303012",
        "itemSeq": 2,
        "itemClass": "Details",
        "itemClassName": "明细",
        "detailsStatus": "Draft",
        "matCode": "14305701710086",
        "matName": "火牛电线-RVV25-深圳-华诚泰",
        "special": "RVV25",
        "materialSize": "",
        "supmatCode": "test002",
        "supmatName": "测试数据2",
        "matShorthand": "火牛电线",
        "parentNames": "W-五金仓库》143-电器类》143057-电线类",
        "materialQualityCode": "",
        "materialQualityName": "",
        "mmsatShow": "",
        "placeOfProd": "深圳",
        "brand": "华诚泰",
        "brandCodes": "",
        "brandNames": "",
        "matgroupCode": "1430570171",
        "matgroupName": "铜芯线",
        "currencyCode": "RMB",
        "pUomType": "lengthUom",
        "pUomName": "长度单位",
        "uomTypeName": "",
        "contractUomId": "unit006",
        "contractUom": "米",
        "purchaseUomId": "unit006",
        "purchaseUom": "米",
        "stockUomPrice": 8.563,
        "stockUomDigit": "",
        "uomRate": 1,
        "price": 8.563,
        "auxiliaryPrice": "",
        "digit": "",
        "amount": "",
        "materialDescription": "",
        "incidentals": "",
        "printPrice": "",
        "printPprice": "",
        "pprice": "",
        "size": "",
        "binding": "",
        "technology": "",
        "advertiseOrganization": "",
        "advertiseAttribute": "",
        "isFreight": "N",
        "isFreightName": "否",
        "isCarton": "N",
        "isCartonName": "否",
        "ratio": 0,
        "matgroupSpecial": "",
        "matgroupGrade": "",
        "matgroupPlaceOfProd": "",
        "dRemark": "",
        "packingStandard": "",
        "itemType": "Routine",
        "itemTypeName": "常规",
        "inDigit": "",
        "inAmount": "",
        "noInDigit": "",
        "noInAmount": "",
        "changeCode": "",
        "stopReason": "",
        "stopDate": "",
        "creator": "1000078",
        "creatorName": "严冠明",
        "createTime": "2021-03-03 16:25:58",
        "removed": "false",
        "lastModifierId": "1000078",
        "lastModifierName": "严冠明",
        "lastModifierTime": "2021-03-03 16:25:58",
        "deposit": "N",
        "depositName": "否",
        "stockDigits": 0,
        "dremark": "",
        "_XID": "row_341",
    },
    {
        "id": 432340,
        "contractNo": "PC210303012",
        "itemSeq": 3,
        "itemClass": "Details",
        "itemClassName": "明细",
        "detailsStatus": "Draft",
        "matCode": "14307300000002",
        "matName": "变送器-E3-C35S-苏州-YAMATE",
        "special": "E3-C35S",
        "materialSize": "",
        "supmatCode": "test003",
        "supmatName": "测试数据3",
        "matShorthand": "变送器",
        "parentNames": "W-五金仓库》143-电器类",
        "materialQualityCode": "",
        "materialQualityName": "",
        "mmsatShow": "",
        "placeOfProd": "苏州",
        "brand": "YAMATE",
        "brandCodes": "",
        "brandNames": "",
        "matgroupCode": "143073",
        "matgroupName": "变送器",
        "currencyCode": "RMB",
        "pUomType": "numberUom",
        "pUomName": "数量单位",
        "uomTypeName": "",
        "contractUomId": "unit033",
        "contractUom": "个",
        "purchaseUomId": "unit033",
        "purchaseUom": "个",
        "stockUomPrice": 56.3687,
        "stockUomDigit": "",
        "uomRate": 1,
        "price": 56.3687,
        "auxiliaryPrice": "",
        "digit": "",
        "amount": "",
        "materialDescription": "",
        "incidentals": "",
        "printPrice": "",
        "printPprice": "",
        "pprice": "",
        "size": "",
        "binding": "",
        "technology": "",
        "advertiseOrganization": "",
        "advertiseAttribute": "",
        "isFreight": "N",
        "isFreightName": "否",
        "isCarton": "N",
        "isCartonName": "否",
        "ratio": 0,
        "matgroupSpecial": "",
        "matgroupGrade": "",
        "matgroupPlaceOfProd": "",
        "dRemark": "",
        "packingStandard": "",
        "itemType": "Routine",
        "itemTypeName": "常规",
        "inDigit": "",
        "inAmount": "",
        "noInDigit": "",
        "noInAmount": "",
        "changeCode": "",
        "stopReason": "",
        "stopDate": "",
        "creator": "1000078",
        "creatorName": "严冠明",
        "createTime": "2021-03-03 16:25:58",
        "removed": "false",
        "lastModifierId": "1000078",
        "lastModifierName": "严冠明",
        "lastModifierTime": "2021-03-03 16:25:58",
        "deposit": "N",
        "depositName": "否",
        "stockDigits": 0,
        "dremark": "",
        "_XID": "row_342",
    },
    {
        "id": 432341,
        "contractNo": "PC210303012",
        "itemSeq": 4,
        "itemClass": "Details",
        "itemClassName": "明细",
        "detailsStatus": "Draft",
        "matCode": "14400300110008",
        "matName": "气管变径三通-PEG12-10-浙江-嘉成",
        "special": "PEG12-10",
        "materialSize": "",
        "supmatCode": "test004",
        "supmatName": "测试数据4",
        "matShorthand": "气管变径三通",
        "parentNames": "W-五金仓库》144-电气类》144003-气管接头",
        "materialQualityCode": "",
        "materialQualityName": "",
        "mmsatShow": "",
        "placeOfProd": "浙江",
        "brand": "嘉成",
        "brandCodes": "",
        "brandNames": "",
        "matgroupCode": "1440030011",
        "matgroupName": "气管三通",
        "currencyCode": "RMB",
        "pUomType": "numberUom",
        "pUomName": "数量单位",
        "uomTypeName": "",
        "contractUomId": "unit033",
        "contractUom": "个",
        "purchaseUomId": "unit033",
        "purchaseUom": "个",
        "stockUomPrice": 3.2546,
        "stockUomDigit": "",
        "uomRate": 1,
        "price": 3.2546,
        "auxiliaryPrice": "",
        "digit": "",
        "amount": "",
        "materialDescription": "",
        "incidentals": "",
        "printPrice": "",
        "printPprice": "",
        "pprice": "",
        "size": "",
        "binding": "",
        "technology": "",
        "advertiseOrganization": "",
        "advertiseAttribute": "",
        "isFreight": "N",
        "isFreightName": "否",
        "isCarton": "N",
        "isCartonName": "否",
        "ratio": 0,
        "matgroupSpecial": "",
        "matgroupGrade": "",
        "matgroupPlaceOfProd": "",
        "dRemark": "T型\\塑料",
        "packingStandard": "",
        "itemType": "Routine",
        "itemTypeName": "常规",
        "inDigit": "",
        "inAmount": "",
        "noInDigit": "",
        "noInAmount": "",
        "changeCode": "",
        "stopReason": "",
        "stopDate": "",
        "creator": "1000078",
        "creatorName": "严冠明",
        "createTime": "2021-03-03 16:25:58",
        "removed": "false",
        "lastModifierId": "1000078",
        "lastModifierName": "严冠明",
        "lastModifierTime": "2021-03-03 16:25:58",
        "deposit": "N",
        "depositName": "否",
        "stockDigits": 0,
        "dremark": "T型\\塑料",
        "_XID": "row_343",
    },
    {
        "id": 432342,
        "contractNo": "PC210303012",
        "itemSeq": 5,
        "itemClass": "Details",
        "itemClassName": "明细",
        "detailsStatus": "Draft",
        "matCode": "14400300110007",
        "matName": "快拧三通-KLE-08-浙江-飞泰",
        "special": "KLE-08",
        "materialSize": "",
        "supmatCode": "test005",
        "supmatName": "测试数据5",
        "matShorthand": "快拧三通",
        "parentNames": "W-五金仓库》144-电气类》144003-气管接头",
        "materialQualityCode": "",
        "materialQualityName": "",
        "mmsatShow": "",
        "placeOfProd": "浙江",
        "brand": "飞泰",
        "brandCodes": "",
        "brandNames": "",
        "matgroupCode": "1440030011",
        "matgroupName": "气管三通",
        "currencyCode": "RMB",
        "pUomType": "numberUom",
        "pUomName": "数量单位",
        "uomTypeName": "",
        "contractUomId": "unit033",
        "contractUom": "个",
        "purchaseUomId": "unit033",
        "purchaseUom": "个",
        "stockUomPrice": 8.6666,
        "stockUomDigit": "",
        "uomRate": 1,
        "price": 8.6666,
        "auxiliaryPrice": "",
        "digit": "",
        "amount": "",
        "materialDescription": "",
        "incidentals": "",
        "printPrice": "",
        "printPprice": "",
        "pprice": "",
        "size": "",
        "binding": "",
        "technology": "",
        "advertiseOrganization": "",
        "advertiseAttribute": "",
        "isFreight": "N",
        "isFreightName": "否",
        "isCarton": "N",
        "isCartonName": "否",
        "ratio": 0,
        "matgroupSpecial": "",
        "matgroupGrade": "",
        "matgroupPlaceOfProd": "",
        "dRemark": "",
        "packingStandard": "",
        "itemType": "Routine",
        "itemTypeName": "常规",
        "inDigit": "",
        "inAmount": "",
        "noInDigit": "",
        "noInAmount": "",
        "changeCode": "",
        "stopReason": "",
        "stopDate": "",
        "creator": "1000078",
        "creatorName": "严冠明",
        "createTime": "2021-03-03 16:25:58",
        "removed": "false",
        "lastModifierId": "1000078",
        "lastModifierName": "严冠明",
        "lastModifierTime": "2021-03-03 16:25:58",
        "deposit": "N",
        "depositName": "否",
        "stockDigits": 0,
        "dremark": "",
        "_XID": "row_344",
    },
]

# 采购合同保存接口params
purchase_contract_save_params = {
    "dossierNo": "接口自动化生成-2021",
    "orderDate": get_today_date(),
    "supCode": "0101353",
    "supName": "广东大华轴承有限公司",
    "planDateSt": get_pass_date(20),
    "planDateEnd": get_future_date(60),
    "companyCode": "101",
    "companyName": "广东新明珠陶瓷集团有限公司",
    "matTypeCode": "ctp001",
    "matTypeName": "五金件采购",
    "status": "Draft",
    "versionNo": "1.0",
    "currencyCode": "RMB",
    "factoryCodes": "21001,21003,21101",
    "factoryNames": "江西一厂,江西二厂,湖北新明珠绿色建材科技有限公司",
    "depotCodes": "HBWJ,JXGF,JXWJ1",
    "depotNames": "湖北新明珠绿色建材五金仓,江西新明珠建材工服仓,江西新明珠建材壹厂五金仓",
    "contractDescribe": "接口自动化生成",
    "deposit": "Y",
    "depositName": "是",
    "contractCategoryCode": "original",
    "contractCategoryName": "原件合同",
    "contractTypeCode": "year",
    "contractTypeName": "年度合同",
    "paymentCode": "ElectronicBankAcceptanceBill",
    "paymentName": "电子银行承兑汇",
    "settlementCode": "ConfirmOrder",
    "settlementName": "对单后",
    "settlementDay": "90",
    "rateCode": "thirteen",
    "rateName": "13",
    "contractSignedDate": get_pass_date(10),
    "outCarton": "N",
    "outCartonName": "否",
    "factoryDepot": "24,22,14,13",
    "creator": "1010537",
    "creatorName": "肖建文",
    "modifier": "0",
    "removed": "false",
    "matClick": "Matgroup",
    "skipWarn": "true",
}

# 采购合同保存接口请求体
purchase_contract_save_body = {
    "enclosureList": "[]",
    "detailsJson": "{}".format(detailsJson),
    "matgroupJson": "[]",
}

# 采购合同提交接口的params
purchase_contract_submit_data = {
    "dossierNo": "接口自动化生成-2021",
    "orderDate": get_today_date(),
    "supCode": "0101353",
    "supName": "广东大华轴承有限公司",
    "planDateSt": get_pass_date(20),
    "planDateEnd": get_future_date(60),
    "companyCode": "101",
    "companyName": "广东新明珠陶瓷集团有限公司",
    "matTypeCode": "ctp001",
    "matTypeName": "五金件采购",
    "status": "Submit",
    "versionNo": "1.0",
    "currencyCode": "RMB",
    "factoryCodes": "20201",
    "factoryNames": "南庄三厂",
    "depotCodes": "GLGF",
    "depotNames": "广东格莱斯工服仓",
    "contractDescribe": "接口自动化生成",
    "deposit": "Y",
    "depositName": "是",
    "contractCategoryCode": "original",
    "contractCategoryName": "原件合同",
    "contractTypeCode": "year",
    "contractTypeName": "年度合同",
    "paymentCode": "ElectronicBankAcceptanceBill",
    "paymentName": "电子银行承兑汇",
    "settlementCode": "ConfirmOrder",
    "settlementName": "对单后",
    "settlementDay": "90",
    "rateCode": "thirteen",
    "rateName": "13",
    "contractSignedDate": get_pass_date(5),
    "outCarton": "N",
    "outCartonName": "否",
    "factoryDepot": "14",
    "creator": 1000150,
    "creatorName": "肖建文",
    "modifier": "0",
    "removed": "false",
    "matClick": "Matgroup",
    "skipWarn": "true",
}

# 采购合同提交审核接口请求体
purchase_contract_submit_body = {
    "enclosureList": "[]",
    "detailsJson": "{}".format(detailsJson),
    "matgroupJson": "[]",
}
